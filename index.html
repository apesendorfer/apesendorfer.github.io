<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title style = "font-family: “Roboto”";>Finesse: A Context-Dependent Thesaurus</title>
        <meta name="description" content = "Enter your text and find meaningful synonyms tailored to your writing. Enjoy!">
        <meta property="og:title" content = "Finesse: Find the Perfect Word">
        <meta property="og:description" content = "Enter your text and find meaningful synonyms tailored to your writing. Enjoy!">
	<link rel="preload" href="https://fonts.googleapis.com/css?family=Roboto&display=swap" as="style">
	<link rel="stylesheet" href="styles.css">
  	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    </head>
    <body style="background: #F9E4D9;">
      <div class="container">
        <div class="descrip">
          <h1 id = "header">Finesse</h1>
          <h3 class="center">A Literary Thesaurus, Powered by AI</h3>
          <button id="finesseButton" class="startButton" type="button" onclick="f1()" data-toggle="tooltip" data-placement="top" title="Run the tool">Finesse it</button>
          <br>
            <div style="max-width:100%">
                <textarea class="center" id="textarea1" name="name" rows="15" cols="100" placeholder="Your text here "></textarea>
              </div>
            <div id="static-input" style = "max-width: 80%;"></div>
            <div id="choices"></div>
            <div id="tools" style="margin-top: 10px">
              <button type="button" onclick="change()">Change</button>
              <button type="button" onclick="revert()">Revert</button>
            </div>
            <!-- <div class="out" id="output">Output Text Here</div> -->
        </div>
      </div>
      <img id="scroller" class="triangleImg" src="triangle.png" style="margin: auto; width: 3%;" 
      onclick="document.getElementById('info').scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' })">
	    <!--<button id="scroller" class="triangle" style="margin: auto; width: 3%; margin-bottom: 200px;" 
		    onclick="document.getElementById('info').scrollIntoView({ behavior: 'smooth', block: 'center' })"></button>
      -->
	    <div style="max-width: 80%;">
		    <h3 id="info">How to use Finesse</h3>
              <div>Ever been frustrated Googling synonyms? 
		      Here's your solution. Finesse helps you find the perfect word. Instead of giving rigid, imprecise suggestions like a thesaurus might, Finesse 
		    relies on a dataset of the best writers around to give you creative, powerful synonyms. We found the words that make these writers unique, then used machine
		    learning to connect them to your text input. Not every connection is an exact synonym: that's what makes finesse brilliant. You'll get ideas, too.</div>
		    <ol>
		  <li>Type in anything (though you'll get the fastest results with a paragraph or less). </li>
		  <li>Finesse it. Usually a pretty fast process unless you're the first user in a long time. Never more than 30 seconds.</li>
		  <li>Mouse over a word to see suggestions!</li>
		<li>Either click on the suggestion or a number on your keyboard, 1-5, to change the word.</li>
			    <li>Hit "Change" to push the changes to the text.</li>
		</ol>
		    <div>Here are some fun examples: </div>
		    <ul>
			  <li>This sentence is very vague.</li>
			  <li>After spending years developing an understanding of the nature of yearning, the narrator finds a fluid, quiet peace.</li>
			  <li>Awesome sauce!</li>
			</ul>
              <h3>What's Next?</h3>
              <div>Finesse is a foundation. We want changing words to change the world: not just finding synonyms, but being more conscious of how we use write. 
		    Racial and gender biases are rooted in language. Tools like Finesse can detect those biases by making their own connections between words. 
		    We hope to empower that research process by proving its feasibility and practicality. Thanks for being a part of step 1, and stay tuned for what's next.</div>
		     <ul>
			  <li>Want to write like your favorite author? You can! Retrain Finesse on any text you want through our GitHub (functionality coming soon).</li>
			  <li>Want to support us? We'd love for you to donate to the <a href="https://cli.org/donate-2/" target="_blank"> Children's Literacy Initiative</a>.</li>
			  <li>Have any feedback? Reach out at guzovsky [@] princeton.edu.</li>
			</ul>
      </div>
      <!--<div style="margin-bottom: 200px;"></div>-->
      <br>
      <br>
      </body>
      </html>
        <script>
        var output_list;
        var input_list;
        var sent_length;
        var punctuation = [".", ",", ";", ":", "!", "?", "-", "`", "--", "---", "—", ")", "]", "}", "'", "\""]
        var inputText;
        function f1() {
          element = document.getElementById("finesseButton");
          element.disabled = true;
          element.style.animation = "bgColor 10s infinite linear";
          inputText = document.getElementById("textarea1").value;
          inputText = inputText.replaceAll("\n", " NewLineMarker ");
          console.log(inputText);
          var payload = {
            method: 'POST', // *GET, POST, PUT, DELETE, etc.
            mode: 'cors', // no-cors, *cors, same-origin
            body: JSON.stringify(inputText),
            headers: {
              'origin': 'https://withfinesse.io',
              'Content-Type': 'application/json',
            // body: JSON.stringify(data) // body data type must match "Content-Type" header
            },
          
          };
          const Url = "https://i7a0fn1zof.execute-api.us-east-2.amazonaws.com/test/suggestions";
          var outputText = "";
          // var input_list;
          fetch(Url, payload)
            .then(function (response) {
              return response.json()
            })
            .then(function (data) {
              // console.log("data: ", data);
              input_list = data[0].slice(1, data[0].length - 1);
              output_list = data[1].slice(1, data[1].length - 1);
              sent_length = input_list.length;
              f2(input_list)
              // document.getElementById("output").innerHTML = data;
            });
          // document.getElementById("output").innerHTML = outputText;
          // var input_list = ["", "Test", "sentence", "."];
          
          
          
        }

        function f2(input_list) {
          text = "<span class='center'>"
          for (let i = 0; i < input_list.length; i++) {
            if (input_list[i].length > 0) {
              if (input_list[i] == "NewLineMarker") {
                text += "<br>"
              }
              else {
                text += "<span id=\"" + i + "\" onmouseover=\"f3(" + i + ")\"" + " onmouseout=\"f5(this)\">" + input_list[i] + " " + "</span>";
              }
            }
          }
          text += "</span>"
          document.getElementById("static-input").innerHTML = text;
          element = document.getElementById("finesseButton");
          element.disabled = false;
          element.style.animation = "none";
        }
        // EventHandler takes inputs: event, length, i
        var EventHandler = function() {
          console.log("ENTERED ONKEYDOWN")
          console.log("output_list[i].length:", length)
          console.log("i:", num)
          if (event.key === '1' && length > 0) {
            console.log("PRESSED 1")
            document.getElementById(num).innerHTML = document.getElementById("b0").innerHTML.substring(3) + " ";
          }
          if (event.key === '2' && length > 1) {
            document.getElementById(num).innerHTML = document.getElementById("b1").innerHTML.substring(3) + " ";
          }
          if (event.key === '3' && length > 2) {
            document.getElementById(num).innerHTML = document.getElementById("b2").innerHTML.substring(3) + " ";
          }
          if (event.key === '4' && length > 3) {
            document.getElementById(num).innerHTML = document.getElementById("b3").innerHTML.substring(3) + " ";
          }
          if (event.key === '5' && length > 4) {
            document.getElementById(num).innerHTML = document.getElementById("b4").innerHTML.substring(3) + " ";
          }
        }

        function f3(i) {
          var element = document.getElementById(i)
          element.style.fontWeight = "bold";
          element.style.color = "magenta"
          text2 = "";
          length = output_list[i].length;
          num = i;
          if (output_list[i].length > 0) {
            for (let j = 0; j < output_list[i].length; j++) {
              text2 += "<button style=\"background: #F4BFA1; border-radius: 15px; margin-right: 5px; margin-botton: 5px;\" id=\"b" + j + "\" type=\"button\" onclick=\"f4(this.innerHTML.substring(3), " + i + ")\">" + (j+1) + ". " + output_list[i][j] + "</button>"
            }
          }
          document.getElementById("choices").innerHTML = text2;
          window.addEventListener('keydown', EventHandler.bind(event, length, num));
        }

        function f4(text, i) {
          document.getElementById(i).innerHTML = text + " ";
        }

        function f5(object) {
          object.style.fontWeight = "normal"
          object.style.color = "black"
          console.log("REMOVE EVENTLISTENER")
          window.removeEventListener('keydown', EventHandler);
        }

        function change() {
          str = "";
          for (let i = 0; i < sent_length; i++) {
            if (i + 1 < sent_length) {
              var currentWord = document.getElementById(i).innerHTML;
              var nextWord = document.getElementById(i + 1).innerHTML;
              if (punctuation.includes(nextWord.slice(0, nextWord.length - 1))) {
                str += currentWord.slice(0, currentWord.length - 1);
              }
              else {
                str += document.getElementById(i).innerHTML;
              }
            }
            else {
              str += document.getElementById(i).innerHTML;
            }
          }
          document.getElementById("textarea1").value = str;
        }

        function revert() {
          // str = "";
          // for (let i = 0; i < sent_length; i++) {
          //   str += input_list[i] + " ";
          // }
          // document.getElementById("textarea1").value = str;
          document.getElementById("textarea1").value = inputText;
        }
        </script>
	<footer style = "margin: auto; width: 20%; font-size: 12px;">
  		<p><a href="https://github.com/apesendorfer/finesse" target="_blank">Built with love</a> by Alex & Ben</p>
		<br></br>
	</footer>
    </body>
</html>